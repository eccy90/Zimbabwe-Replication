{"version":3,"sources":["main.js"],"names":[],"mappings":"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","file":"main.plain.js","sourcesContent":["'use strict';\r\n(function (U, $) {\r\n\r\n    if (!Array.from){\r\n        Array.from = function (object) {\r\n            return [].slice.call(object);\r\n        };\r\n    }\r\n\r\n\r\n    /*\r\n    ** Main IPPR object holding all the info about the dom and data\r\n    */\r\n    var IPPR = {\r\n        dom: {\r\n            header: $('.Header'),\r\n            data: $('.Data'),\r\n            lists: {\r\n                main: '.List--main',\r\n                extra: '.List--extra',\r\n                info: '.List--info',\r\n                count: '.List-count',\r\n                header: '.List-header',\r\n                holder: '.List-holder',\r\n                title: '.List-title',\r\n                list: '.collection',\r\n                infoName: '.List-infoName',\r\n                headerActive: '.List-headerActive',\r\n                headerInActive: '.List-headerInactive',\r\n                switch: '.List-switch'\r\n            },\r\n            content: $('.Content'),\r\n            tabs: $('.Header-tabs a'),\r\n            levels: $('div[data-level]'),\r\n            dataHolder: $('.Data-holder'),\r\n            filters: {\r\n                main: '.Filters',\r\n                mobile: '.Filters--mobile',\r\n                item: '.Filters .chip',\r\n                trigger: $('.Filters-trigger'),\r\n                activeHolder: $('.Filters-active'),\r\n                remove: $('Filters-remove'),\r\n                search: $('.Search-field'),\r\n                searchRemove: $('.Search-remove'),\r\n                searchTrigger: $('.Search-trigger'),\r\n            },\r\n            map: $('.Map'),\r\n            mapTrigger: $('.Map-trigger'),\r\n            mapInline: $('.Map--inline'),\r\n            showInfo: '.js-showAdditionalInfo',\r\n            sankey: {\r\n                mobile: '.Sankey-mobile',\r\n                desktop: '.Sankey-desktop',\r\n            },\r\n            additionalInfo: $('.AdditionalInfo'),\r\n            additionalInfoTitle: $('.AdditionalInfo-title'),\r\n            additionalInfoHeader: $('.AdditionalInfo-header'),\r\n            footer: $('.Footer'),\r\n            templates: {\r\n                main: '.main-tpl', // This should get fed company names\r\n                extra: '.extra-tpl', // this should get mines for the company\r\n                licenceTable: '.licenceTable-tpl',\r\n                companyTable: '.companyTable-tpl',\r\n                ownedLicenses: '.ownedLicenses-tpl',\r\n                hierarchy: '.hierarchy-tpl'\r\n            },\r\n            additionalInfoStrings: {\r\n                licence: 'Info for Licence number <span></span>',\r\n                company: 'Additional information'\r\n            },\r\n            ownedLicenses: '.OwnedLicenses',\r\n            hierarchy: '.Hierarchy',\r\n            table: '.Table'\r\n        },\r\n        states: {\r\n            loading: 'is-loading',\r\n            active: 'is-active',\r\n            animate: 'has-animation',\r\n            hidden: 'u-isHidden',\r\n            visible: 'is-visible',\r\n            selected: 'is-selected',\r\n            mobile: false,\r\n            desktop: false,\r\n            view: 'companies',\r\n            hightlight: 'companies',\r\n            map: false,\r\n            filters: false\r\n        },\r\n        data: {\r\n            apiURL: 'https://miningpachena.carto.com/api/v2/sql/?q=',\r\n            data: {},\r\n            tabs: {\r\n                0: {\r\n                    name: 'companies',\r\n                    sql: \"SELECT m.cartodb_id AS mine_id, m.name AS mine_name, m.district AS mine_district, m.region as mine_region, m.status as mine_status, c.cartodb_id AS company_id, c.name AS company_name, c.address AS company_address, c.hq AS company_hq, c.jurisdiction AS company_jurisdiction, c.registration AS company_registration, c.website AS company_website FROM zw_companies c, zw_company_mines cm, zw_mines m WHERE c.cartodb_id = cm.company_id AND cm.mine_id = m.cartodb_id\",\r\n                    groupBy: 'company_id'\r\n                },\r\n                1: {\r\n                    name: 'mines',\r\n                    sql: \"SELECT m.cartodb_id AS mine_id, m.name AS mine_name, m.district AS mine_district, m.region as mine_region, m.status as mine_status, c.cartodb_id AS company_id, c.name AS company_name, c.address AS company_address, c.hq AS company_hq, c.jurisdiction AS company_jurisdiction, c.registration AS company_registration, c.website AS company_website FROM zw_companies c, zw_company_mines cm, zw_mines m WHERE c.cartodb_id = cm.company_id AND cm.mine_id = m.cartodb_id\",\r\n                    groupBy: 'mine_id'\r\n                },\r\n                2: {\r\n                    name: 'minerals',\r\n                    sql: \"SELECT mns.cartodb_id as mine_id, mns.district AS mine_district, mns.name AS mine_name, mns.region AS mine_region, mns.status AS mine_status, mls.name AS mineral FROM zw_mines mns, zw_mine_minerals mm, zw_minerals mls WHERE mns.cartodb_id = mm.mine_id AND mm.mineral_id = mls.cartodb_id\",\r\n                    groupBy: 'mineral'\r\n                }\r\n\r\n            },\r\n        },\r\n        map: {\r\n            map: [],\r\n            layers: [],\r\n            markers: [],\r\n            styles: {\r\n                default: {\r\n                    radius: 8,\r\n                    weight: 1,\r\n                    fill: true,\r\n                    fillColor: '#5E8FB1',\r\n                    dashArray: '',\r\n                    color: '#000',\r\n                    fillOpacity: 1\r\n                },\r\n                active: {\r\n                    radius: 8,\r\n                    weight: 2,\r\n                    fill: true,\r\n                    fillColor: '#256A9A',\r\n                    dashArray: '',\r\n                    color: '#000',\r\n                    fillOpacity: 1\r\n                },\r\n                filtered: {\r\n                    radius: 8,\r\n                    weight: 3,\r\n                    fill: true,\r\n                    fillColor: '#93B4CB',\r\n                    dashArray: '',\r\n                    color: 'transparent',\r\n                    fillOpacity: 1\r\n                }\r\n            },\r\n            highlightLayer: function(key,id){\r\n                \r\n                // collect mine ids for mineral highliting \r\n                if(IPPR.states.highlight === 'minerals'){\r\n                    var minesIds = [];\r\n                    $.each( $('p.List-switch'), function(index, element){\r\n                        minesIds.push( $(element).data('id'));\r\n                    });    \r\n                }\r\n                \r\n                $.each(IPPR.map.layers[key], function(k,value){\r\n\r\n                    IPPR.map.layers[key][k].closePopup();\r\n                    if (!IPPR.states.filters){\r\n                        IPPR.map.layers[key][k].setStyle(IPPR.map.styles.default);\r\n                        $(IPPR.map.markers[key][k]._icon).removeClass(IPPR.states.active);\r\n                        $(IPPR.map.markers[key][k]._icon).removeClass(IPPR.states.selected);\r\n                        IPPR.map.layers[key][k].isActive = false;\r\n                        IPPR.map.markers[key][k].isActive = false;\r\n                    }\r\n\r\n                    if (IPPR.states.highlight === 'mines' && value.ID === id  || IPPR.states.highlight === 'minerals' && (minesIds.indexOf(value.ID) >= 0)  || IPPR.states.highlight === 'companies' && value.company_id === id){\r\n                            \r\n                        /*    \r\n                        if(IPPR.states.highlight === 'minerals'){\r\n                            console.log('-- INIT DEBUG ---');\r\n                            console.log('value.ID: ' + value.ID);\r\n                            console.log('value.cartodb_id: ' + value.cartodb_id);\r\n                            console.log(minesIds);\r\n                            console.log(minesIds.indexOf(value.cartodb_id));\r\n                            console.log('--- EOF DEBUG ---');\r\n                        }\r\n                        */\r\n                        \r\n                        IPPR.map.layers[key][k].setStyle(IPPR.map.styles.active);\r\n                        //IPPR.map.layers[key][k].openPopup();\r\n                        \r\n                        IPPR.map.layers[key][k].bringToFront();\r\n                        IPPR.map.layers[key][k].isActive = true;\r\n                        IPPR.map.markers[key][k].isActive = true;\r\n                        $(IPPR.map.markers[key][k]._icon).addClass(IPPR.states.selected);\r\n                            \r\n                        if(IPPR.states.mobile){\r\n                            setTimeout(function(){\r\n                                if (IPPR.map.markers[key][k]._latlng.lat && IPPR.map.markers[key][k]._latlng.lng){\r\n                                    IPPR.map.map[key].setView(new L.LatLng(IPPR.map.markers[key][k]._latlng.lat, IPPR.map.markers[key][k]._latlng.lng), 6);\r\n                                }\r\n                            },200);\r\n                        }\r\n                        \r\n                    }\r\n\r\n                });\r\n            },\r\n            resetLayers: function(){\r\n                $.each(IPPR.map.layers, function(k,v){\r\n                    $.each(v, function(index) {\r\n                       IPPR.map.layers[k][index].setStyle(IPPR.map.styles.default);\r\n                       $(IPPR.map.markers[k][index]._icon).removeClass(IPPR.states.active);\r\n                       $(IPPR.map.markers[k][index]._icon).removeClass(IPPR.states.selected);\r\n                    });\r\n                });\r\n            },\r\n            searchLayers: function(type){\r\n\r\n                if (!IPPR.states.filters){\r\n                    IPPR.map.resetLayers();\r\n                }\r\n\r\n                var key = type === 'companies' ? 0 : 2,\r\n                    listItems = $(IPPR.dom.lists.main+':visible').find('.collection-item'),\r\n                    ids = [];\r\n\r\n                $.each(listItems, function(index, val) {\r\n                    ids.push($(val).data('id'));\r\n                });\r\n\r\n                $.each(IPPR.map.layers[key], function(k,v){\r\n                    if(IPPR.states.view === 'mines' && $.inArray(v.ID, ids) < 0 || IPPR.states.view === 'minerals' && $.inArray(v.ID, ids) < 0 ||  IPPR.states.view === 'companies' && $.inArray(v.company_id, ids) < 0){\r\n\r\n                        IPPR.map.layers[key][k].setStyle(IPPR.map.styles.filtered);\r\n\r\n                        $(IPPR.map.markers[key][k]._icon).removeClass(IPPR.states.active);\r\n                        $(IPPR.map.markers[key][k]._icon).removeClass(IPPR.states.selected);\r\n                        IPPR.map.layers[key][k].isActive = false;\r\n                        IPPR.map.markers[key][k].isActive = false;\r\n                    } else {\r\n                        $(IPPR.map.markers[key][k]._icon).removeClass(IPPR.states.selected);\r\n                        IPPR.map.layers[key][k].setStyle(IPPR.map.styles.default);\r\n                        IPPR.map.layers[key][k].isActive = true;\r\n                        IPPR.map.markers[key][k].isActive = true;\r\n                    }\r\n                });\r\n\r\n                setTimeout(function(){\r\n                    var size = $(IPPR.dom.lists.main+':visible').find('.collection-item').size();\r\n                    $(IPPR.dom.lists.main).find(IPPR.dom.lists.count).html('('+size+')');\r\n                },50);\r\n\r\n            }\r\n        },\r\n        filters: {\r\n            list: [],\r\n            options: {\r\n                valueNames: ['List-title', 'concessionNumbers', 'expiration'],\r\n                listClass: 'collection',\r\n                searchClass: 'Search-input'\r\n            },\r\n            clear: function(){\r\n                $.each(IPPR.filters.list, function(k){\r\n                    IPPR.filters.list[k].filter();\r\n                });\r\n                $(IPPR.dom.filters.item).removeClass(IPPR.states.active);\r\n                IPPR.dom.filters.search.removeClass(IPPR.states.hidden);\r\n                IPPR.dom.filters.activeHolder.empty();\r\n            }\r\n        },\r\n        helpers: {\r\n            groupBy: function(xs, key) {\r\n                return xs.reduce(function(rv, x) {\r\n                    (rv[x[key]] = rv[x[key]] || []).push(x);\r\n                    return rv;\r\n                }, {});\r\n            },\r\n            unique(value, index, self) {\r\n                return self.indexOf(value) === index;\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n    /*\r\n    ** Set / remove loading classes while the data loads\r\n    */\r\n    IPPR.loading = function(){\r\n        IPPR.dom.data.toggleClass(IPPR.states.loading);\r\n    };\r\n\r\n\r\n    /*\r\n    ** Get the data for each tab and store it in the main IPPR object.\r\n    */\r\n    IPPR.getData = function(){\r\n\r\n        var markup = [],\r\n            mustacheTpl = [],\r\n            title,id,expiration = false;\r\n\r\n        /*\r\n        ** For each tab ...\r\n        */\r\n        $.each(IPPR.data.tabs, function(key, tab){\r\n\r\n            markup[key] = '';\r\n            mustacheTpl[key] = $('#tab-'+key).find(IPPR.dom.templates.main).html();\r\n\r\n            /*\r\n            ** ... get the data from carto.com\r\n            */\r\n            $.getJSON(IPPR.data.apiURL + tab.sql, function(data) {\r\n                /*\r\n                ** ... sort data - broup by, store it the main IPPR object\r\n                */\r\n                IPPR.data.data[key] = IPPR.helpers.groupBy(data.rows, tab.groupBy);\r\n\r\n                /*\r\n                ** .. run through the data, parse the templates\r\n                */\r\n                $.each(IPPR.data.data[key], function(k, value){\r\n\r\n                    /*\r\n                    ** ... parse the template for future use\r\n                    */\r\n                    Mustache.parse(mustacheTpl[key]);\r\n\r\n                    /*\r\n                    ** ... assign data to templates\r\n                    */\r\n                    if (tab.name === 'companies'){\r\n                        title = value[0].company_name;\r\n                        id = value[0].company_id;\r\n                    } else if (tab.name === 'minerals') {\r\n                        title = k;\r\n                        id = k;\r\n                    } else {\r\n                        title = value[0].mine_name;\r\n                        id = value[0].mine_id;\r\n                    }\r\n\r\n                    /*\r\n                    ** ... render templates with the data\r\n                    */\r\n                    markup[key] += Mustache.render(\r\n                        mustacheTpl[key], {\r\n                            title: title,\r\n                            id: id,\r\n                            expiration: expiration\r\n                        }\r\n                    );\r\n                });\r\n\r\n\r\n\r\n                /*\r\n                ** ... append the data to the main lists in each tab\r\n                */\r\n                $('#tab-'+key).find(IPPR.dom.lists.main).find(IPPR.dom.lists.list).html(markup[key]);\r\n                $('#tab-'+key).find(IPPR.dom.lists.main).find(IPPR.dom.lists.count).html('(' + Object.keys(IPPR.data.data[key]).length + ')');\r\n\r\n                /*\r\n                ** ... we are done with the data, set loading to false and turn on the filtering\r\n                */\r\n                if (Object.keys(IPPR.data.tabs).length - 1 === parseInt(key)){\r\n                    IPPR.loading();\r\n                    setTimeout(function(){\r\n                        IPPR.filtering();\r\n                    },300);\r\n                }\r\n\r\n            });\r\n\r\n        });\r\n    };\r\n\r\n    /*\r\n    ** Initialize the maps ...\r\n    */\r\n    IPPR.initMap = function(){\r\n\r\n        /*\r\n        ** ... get the geo json data\r\n        */\r\n        $.getJSON('/data/zw_mines.geojson', function(data){\r\n\r\n            /*\r\n            ** ... for each map in the dom initialize the maps and populate with layers and markers\r\n            */\r\n            $.each(IPPR.dom.map, function(key,val){\r\n\r\n                var that = $(val);\r\n\r\n\r\n                IPPR.map.layers[key] = [];\r\n                IPPR.map.markers[key] = [];\r\n\r\n                /***  little hack starts here ***/\r\n                L.Map = L.Map.extend({\r\n                    openPopup: function(popup) {\r\n                        //        this.closePopup();  // just comment this\r\n                        this._popup = popup;\r\n\r\n                        return this.addLayer(popup).fire('popupopen', {\r\n                            popup: this._popup\r\n                        });\r\n                    }\r\n                }); /***  end of hack ***/\r\n\r\n                /*\r\n                ** ... init map\r\n                */\r\n                IPPR.map.map[key] = L.map($('.Map').eq(key)[0],{\r\n                    scrollWheelZoom: false,\r\n                    zoomControl: false\r\n                }).setView([-18.997, 23.908], 7); // map centering\r\n\r\n                /*\r\n                ** ... change zoom controls to be in the bottom right corner\r\n                */\r\n                L.control.zoom({\r\n                     position:'bottomright'\r\n                }).addTo(IPPR.map.map[key]);\r\n\r\n                /*\r\n                ** ... base layer with the map of the world\r\n                */\r\n                L.tileLayer('http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}@2x.png', {\r\n                    maxZoom: 18\r\n                }).addTo(IPPR.map.map[key]);\r\n\r\n                /*\r\n                ** ... function to be executed on each layer\r\n                */\r\n                function onEachLayer(feature, layer) {\r\n\r\n                    /*\r\n                    ** ... append the data to each layer\r\n                    */\r\n                    $.each(feature.properties, function(index, val) {\r\n                        layer[index] = val;\r\n                    });\r\n\r\n                    /*\r\n                    ** ... extra data\r\n                    */\r\n                    layer.ID = feature.properties.cartodb_id;\r\n                    layer.company_id = feature.properties.company_id;\r\n\r\n                    if (feature.properties && feature.properties.popupContent) {\r\n                        layer.bindPopup(feature.properties.popupContent);\r\n                    } else {\r\n                        layer.bindPopup('<ul class=\"Map-popup\"><li><strong>Name:</strong> '+ feature.properties.name +'</li><li><strong>Region:</strong> '+ feature.properties.region +'</li><li><strong>District:</strong> '+ feature.properties.district +'</li><li><strong>Status:</strong> '+ feature.properties.status +'</li></ul>');\r\n                    }\r\n\r\n                    /*\r\n                    ** ... push the layers for later use\r\n                    */\r\n                    IPPR.map.layers[key].push(layer);\r\n\r\n                    /*\r\n                    ** ... add labels to the polygons\r\n                    */\r\n                    var marker = L.marker(layer._latlng, {\r\n                      icon: L.divIcon({\r\n                            className: 'Map-label'\r\n                        })\r\n                    }).addTo(IPPR.map.map[key]);\r\n                    /*\r\n                    ** ... push the labels for later use\r\n                    */\r\n\r\n                    IPPR.map.markers[key].push(marker);\r\n\r\n                    /*\r\n                    ** ... each layer AND marker/label has a click function\r\n                    */\r\n                    function onClick(){\r\n\r\n                        /*\r\n                        ** ... if the current view is filtered (has active search or filtering) restyle the layers\r\n                        */\r\n                        if (IPPR.states.filters){\r\n                            IPPR.map.searchLayers(IPPR.states.view);\r\n                        }\r\n\r\n                        /*\r\n                        ** ... If this label or marker is not active remove all active filters and reset search\r\n                        */\r\n                        if (!this.isActive){ // jshint ignore:line\r\n                            IPPR.dom.filters.searchRemove.click();\r\n                        }\r\n\r\n\r\n                        /*\r\n                        ** ... click the item in the main list, scroll list to the top\r\n                        */\r\n                        var elem, top;\r\n                        if (that.is('.mines')){\r\n                            elem = $(IPPR.dom.lists.main).find('li[data-id=\"'+ feature.properties.license_id +'\"]');\r\n                            elem.click();\r\n                            top = elem.position().top;\r\n                            $(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).scrollTop(top);\r\n                        } else if (that.is('.companies')){\r\n                            elem = $(IPPR.dom.lists.main).find('li[data-id=\"'+ feature.properties.company_id +'\"]');\r\n                            elem.click();\r\n                            top = elem.position().top;\r\n                            $(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).scrollTop(top);\r\n                        }\r\n\r\n\r\n                    }\r\n\r\n                    /*\r\n                    ** ... assign the click events on layers and markers/labels\r\n                    */\r\n                    marker.on('click',onClick);\r\n                    layer.on('click',onClick);\r\n                }\r\n\r\n                /*\r\n                ** ... parse the geojson data and add it to the map\r\n                */\r\n                L.geoJson([data], {\r\n                    pointToLayer: function (feature, latlng) {\r\n                        return L.circleMarker(latlng, IPPR.map.styles.default);\r\n                    },\r\n                    onEachFeature: onEachLayer\r\n                })\r\n                .addTo(IPPR.map.map[key]);\r\n\r\n            });\r\n\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /*\r\n    ** Switch from licence to company and vice versa with that licence or company selected\r\n    */\r\n    $(document).on('click', IPPR.dom.lists.switch, function(){\r\n        var id = $(this).data('id'),\r\n            view = $(this).data('to');\r\n\r\n        IPPR.states.view = view;\r\n\r\n        $('a[data-view=\"'+view+'\"]').click();\r\n\r\n        setTimeout(function(){\r\n            $('.collection-item[data-id=\"'+id+'\"]').click();\r\n            var top = $('.collection-item[data-id=\"'+id+'\"]').position().top;\r\n            $(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).scrollTop(top);\r\n        },100);\r\n\r\n    });\r\n\r\n    /*\r\n    ** Display additional data for each clicked licence and compay below the main elements (lists with map) ...\r\n    */\r\n    IPPR.displayAdditionalInfo = function(item,type){\r\n\r\n        var tableData,title,mustacheTpl,finalTable,hierarchyTpl,finalHierarchy;\r\n\r\n        /*\r\n        ** ... if this is licence\r\n        */\r\n        if (type === 'mine'){\r\n\r\n\r\n            /*\r\n            ** ... append the title, change the background color\r\n            */\r\n            $(IPPR.dom.additionalInfoTitle).html(IPPR.dom.additionalInfoStrings[type]);\r\n            $(IPPR.dom.additionalInfoHeader).removeClass('green').addClass('blue');\r\n\r\n            /*\r\n            ** ... get the data from data attributes\r\n            */\r\n            title = item.find(IPPR.dom.lists.title).html();\r\n\r\n            /*\r\n            ** ... get and parse the template for the table\r\n            */\r\n            mustacheTpl = $(IPPR.dom.templates.licenceTable).html();\r\n            Mustache.parse(mustacheTpl);\r\n/*\r\n           $.getJSON(IPPR.data.apiURL + \"SELECT * FROM na_detailed_license_transfers WHERE license_id = \" + item.data('id') + ' ORDER BY transfer_date&api_key=6fce048c2d9eb832fb12e78b4252d18c7f0b2411', function(data) {\r\n\r\n                var sankeyData = [];\r\n                // [[ \"Goverment of Namibia 100%\", \"Eco oil and gas 20%\", 10, \"20%\"],[ \"Eco oil and gas 20%\", \"Eco oil and gas 10%\", 5, \"10%\" ],[ \"Eco oil and gas 20%\", \"New Buyer 10%\", 5, \"10%\" ],[ \"Goverment of Namibia 100%\", \"Goverment of Namibia 80%\", 8, \"80%\"]]\r\n\r\n\r\n                finalTable = Mustache.render(\r\n                    mustacheTpl, {\r\n                        tableRows: Array.from(data.rows),\r\n                    }\r\n                );\r\n\r\n                $.each(data.rows, function(index, val) {\r\n                    sankeyData.push([val.seller,val.buyer, Math.ceil(val.buyer_stake_after || 100), val.seller_stake_prior + '% ->' + val.buyer_stake_after + '%']);\r\n                });\r\n\r\n                if (IPPR.states.mobile){\r\n\r\n                    /*\r\n                    ** ... draw sankey graph\r\n                    */   /*\r\n                    IPPR.sankey(sankeyData, IPPR.dom.sankey.mobile);\r\n                    $(IPPR.dom.lists.info).find(IPPR.dom.table).html(finalTable);\r\n                    IPPR.dom.additionalInfo.addClass(IPPR.states.hidden);\r\n                } else {\r\n                    $(IPPR.dom.sankey.desktop).removeClass(IPPR.states.hidden);\r\n                    IPPR.sankey(sankeyData, IPPR.dom.sankey.desktop);\r\n                    IPPR.dom.additionalInfo.find(IPPR.dom.table).html(finalTable);\r\n                }\r\n\r\n            });\r\n*/\r\n            /*\r\n            ** ... hide the company addition info because we are on licences\r\n            */\r\n            IPPR.dom.additionalInfo.find(IPPR.dom.ownedLicenses).addClass(IPPR.states.hidden);\r\n            IPPR.dom.additionalInfo.find(IPPR.dom.hierarchy).addClass(IPPR.states.hidden);\r\n\r\n\r\n            /*\r\n            ** ... append data to the DOM\r\n            */\r\n            if (IPPR.states.mobile){\r\n                $(IPPR.dom.lists.info).find(IPPR.dom.lists.infoName).html(title);\r\n                IPPR.dom.additionalInfo.addClass(IPPR.states.hidden);\r\n            } else {\r\n                IPPR.dom.additionalInfo.removeClass(IPPR.states.hidden);\r\n                IPPR.dom.additionalInfo.find('.AdditionalInfo-title span').html(title);\r\n            }\r\n        } else if (type === 'company'){\r\n            /*\r\n            ** ... if this is company, get the data and append to the DOM\r\n            */\r\n\r\n            $(IPPR.dom.additionalInfoTitle).html(IPPR.dom.additionalInfoStrings[type]);\r\n            $(IPPR.dom.additionalInfoHeader).removeClass('blue').addClass('green');\r\n\r\n            IPPR.dom.additionalInfo.removeClass(IPPR.states.hidden);\r\n\r\n            tableData = IPPR.data.data[0][item.data('id')][0];\r\n            // ownedLicenses = item.data('ownedlicenses');\r\n\r\n            mustacheTpl = $(IPPR.dom.templates.companyTable).html();\r\n            // ownedLicensesTpl = $('.ownedLicenses-tpl').html();\r\n            hierarchyTpl = $(IPPR.dom.templates.hierarchy).html();\r\n\r\n            Mustache.parse(mustacheTpl);\r\n            // Mustache.parse(ownedLicensesTpl);\r\n            Mustache.parse(hierarchyTpl);\r\n\r\n            finalTable = Mustache.render(\r\n                mustacheTpl, {\r\n                    tableRows: tableData,\r\n                }\r\n            );\r\n\r\n            // finalownedLicenses = Mustache.render(\r\n            //     ownedLicensesTpl, {\r\n            //         licence: Array.from(ownedLicenses),\r\n            //     }\r\n            // );\r\n\r\n            /*\r\n            ** ... get the company info and append to the DOM\r\n            ** SELECT * FROM na_people WHERE company_id = 6 ORDER BY name ASC\r\n            */\r\n\r\n            $.getJSON('https://miningpachena.carto.com/api/v2/sql/?q=SELECT * FROM zw_people WHERE company_id = ' + item.data('id'), function(data) {\r\n\r\n                finalHierarchy = Mustache.render(\r\n                    hierarchyTpl, {\r\n                        hierarchy: data.rows,\r\n                    }\r\n                );\r\n\r\n                if (IPPR.states.mobile){\r\n                    $(IPPR.dom.lists.extra).find(IPPR.dom.hierarchy).html(finalHierarchy);\r\n                } else {\r\n                    IPPR.dom.additionalInfo.find(IPPR.dom.hierarchy).html(finalHierarchy).removeClass(IPPR.states.hidden);\r\n                }\r\n            });\r\n\r\n            if (IPPR.states.mobile){\r\n                $(IPPR.dom.lists.extra).find(IPPR.dom.table).html(finalTable);\r\n                // $(IPPR.dom.lists.extra).find('.OwnedLicenses').html(finalownedLicenses);\r\n                IPPR.dom.additionalInfo.addClass(IPPR.states.hidden);\r\n            } else {\r\n                IPPR.dom.additionalInfo.removeClass(IPPR.states.hidden);\r\n                IPPR.dom.additionalInfo.find(IPPR.dom.table).html(finalTable).removeClass(IPPR.states.hidden);\r\n                // IPPR.dom.additionalInfo.find('.OwnedLicenses').html(finalownedLicenses).removeClass(IPPR.states.hidden);\r\n            }\r\n\r\n\r\n        } else { // minerals\r\n\r\n        }\r\n\r\n\r\n    };\r\n\r\n    // Mobile behaviour of the app\r\n    IPPR.mobile = function(){\r\n        /*\r\n        ** ... Set the desktop to false\r\n        */\r\n        IPPR.states.desktop = false;\r\n\r\n        /*\r\n        ** ... unbind the click event on the tabs\r\n        */\r\n        IPPR.dom.tabs.off('click.mobile');\r\n\r\n        /*\r\n        ** ... bind the click event on the tabs\r\n        */\r\n        IPPR.dom.tabs.on('click.mobile', function(){\r\n\r\n            IPPR.states.filters = false;\r\n            IPPR.dom.filters.searchTrigger.removeClass(IPPR.states.hidden);\r\n            IPPR.dom.filters.searchRemove.removeClass(IPPR.states.visible);\r\n            IPPR.dom.filters.searchRemove.click();\r\n            IPPR.filters.clear();\r\n\r\n            /*\r\n            ** ... hide the footer when on mobile view\r\n            */\r\n            setTimeout(function(){\r\n                IPPR.dom.footer.addClass(IPPR.states.hidden);\r\n            }, 400);\r\n\r\n            IPPR.map.resetLayers();\r\n\r\n            /*\r\n            ** ... set the content to be visible and slide in the content\r\n            */\r\n            IPPR.dom.content.addClass(IPPR.states.active);\r\n\r\n            setTimeout(function(){\r\n                IPPR.dom.content.addClass(IPPR.states.animate);\r\n                $.each(IPPR.map.map, function(key,value){\r\n                    if(value){\r\n                        value.invalidateSize();\r\n                    }\r\n                });\r\n            }, 100);\r\n\r\n            IPPR.states.view = $(this).data('view');\r\n\r\n            if(IPPR.states.view === 'mines'){\r\n                IPPR.dom.mapTrigger.addClass(IPPR.states.active);\r\n            } else {\r\n                IPPR.dom.map.removeClass(IPPR.states.visible);\r\n                $(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).removeClass(IPPR.states.hidden);\r\n                IPPR.dom.mapTrigger.find('.material-icons').html('map');\r\n            }\r\n        });\r\n\r\n        /*\r\n        ** ... levels are the main header links (licence<->info), so we check and slide the content to left or right depending on the current level\r\n        */\r\n        $.each(IPPR.dom.levels, function(key, value){\r\n            var level = $(this).data('level');\r\n\r\n            $(value).find(IPPR.dom.lists.header).off('click');\r\n            $(value).find(IPPR.dom.lists.header).on('click', function(){\r\n                if (level === 0){ // Inital non selected view\r\n                    IPPR.dom.footer.removeClass(IPPR.states.hidden);\r\n                    IPPR.dom.content.removeClass(IPPR.states.animate);\r\n                    setTimeout(function(){\r\n                        IPPR.dom.content.removeClass(IPPR.states.active);\r\n                    }, 100);\r\n                    IPPR.dom.mapTrigger.removeClass(IPPR.states.active);\r\n\r\n                } else if (level === 1){ // 1st list\r\n                    IPPR.dom.dataHolder.css({transform: 'translate(0,0)'});\r\n                    if(IPPR.states.view === 'mines'){\r\n                        IPPR.dom.mapTrigger.addClass(IPPR.states.active);\r\n                    }\r\n                    IPPR.dom.map.removeClass(IPPR.states.hidden);\r\n                    $.each(IPPR.map.map, function(key,value){\r\n                        if(value){\r\n                            value.invalidateSize();\r\n                        }\r\n                    });\r\n                    $(IPPR.dom.lists.extra).addClass(IPPR.states.hidden);\r\n                    $(IPPR.dom.lists.info).addClass(IPPR.states.hidden);\r\n\r\n                    if (IPPR.dom.mapTrigger.find('.material-icons').html() === 'map'){\r\n                        $(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).removeClass(IPPR.states.hidden);\r\n                    }\r\n\r\n                } else if (level === 2){ // second list\r\n                    IPPR.dom.dataHolder.css({transform: 'translate(-33.3333%,0)'});\r\n                }\r\n            });\r\n        });\r\n\r\n        /*\r\n        ** ... show license additional info (orange button)\r\n        */\r\n        $(document).on('click', IPPR.dom.showInfo, function(e){\r\n            e.preventDefault();\r\n\r\n            var item = $(this).closest(IPPR.dom.dataHolder).find('.collection-item.is-active');\r\n            IPPR.displayAdditionalInfo(item, 'licence');\r\n\r\n            $(IPPR.dom.lists.info).removeClass(IPPR.states.hidden);\r\n            IPPR.dom.dataHolder.css({transform: 'translate(-66.6666%,0)'});\r\n            $(window).scrollTop(0);\r\n        });\r\n\r\n\r\n\r\n        IPPR.states.mobile = true;\r\n    };\r\n\r\n    // Desktop behaviour of the app\r\n    IPPR.desktop = function(){\r\n\r\n        IPPR.states.mobile = false;\r\n        IPPR.dom.tabs.off('click.desktop');\r\n        $(IPPR.dom.lists.extra).removeClass(IPPR.states.hidden);\r\n\r\n        IPPR.dom.tabs.on('click.desktop', function(){\r\n\r\n            IPPR.states.filters = false;\r\n            IPPR.dom.filters.searchTrigger.removeClass(IPPR.states.hidden);\r\n            IPPR.dom.filters.searchRemove.removeClass(IPPR.states.visible);\r\n            IPPR.dom.filters.searchRemove.click();\r\n            IPPR.filters.clear();\r\n\r\n            IPPR.map.resetLayers();\r\n\r\n            /*\r\n            ** ... we need to reset the leaflet state so it repositions the map view\r\n            */\r\n            setTimeout(function(){\r\n                $.each(IPPR.map.map, function(key,value){\r\n                    if(value){\r\n                        value.invalidateSize();\r\n                    }\r\n                });\r\n            },100);\r\n            IPPR.states.view = $(this).data('view');\r\n            IPPR.dom.additionalInfo.addClass(IPPR.states.hidden);\r\n        });\r\n\r\n        /*\r\n        ** ... enable the map to be draggable\r\n        */\r\n        $.each(IPPR.map.map, function(k,v){\r\n            v.dragging.enable();\r\n        });\r\n\r\n        IPPR.states.desktop = true;\r\n    };\r\n\r\n    /*\r\n    ** On each clicked item in the lists do something ...\r\n    */\r\n    IPPR.listDetails = function(){\r\n\r\n        var markup = [],\r\n            mustacheTpl = [];\r\n\r\n        $.each(IPPR.data.tabs, function(key){\r\n\r\n            mustacheTpl[key] = $('#tab-'+key).find('.extra-tpl').html();\r\n\r\n            $('#tab-'+key).on('click', '.collection-item', function(){\r\n\r\n                if (IPPR.states.filters){\r\n                    IPPR.map.searchLayers(IPPR.states.view);\r\n                }\r\n\r\n                markup[key] = '';\r\n\r\n                IPPR.dom.mapTrigger.removeClass(IPPR.states.active);\r\n\r\n                $(this).parent().find('li').removeClass(IPPR.states.active);\r\n                $(this).addClass(IPPR.states.active);\r\n\r\n                if (IPPR.states.mobile){\r\n                    IPPR.dom.dataHolder.css({transform: 'translate(-33.3333%,0)'});\r\n                    if(IPPR.states.view === 'mines'){\r\n                        IPPR.dom.map.addClass(IPPR.states.hidden);\r\n                    } else {\r\n                        IPPR.dom.mapInline.removeClass(IPPR.states.hidden);\r\n                    }\r\n                    $(window).scrollTop(0);\r\n                } else {\r\n                    IPPR.dom.map.removeClass(IPPR.states.hidden);\r\n                }\r\n\r\n                var id = $(this).data('id'),\r\n                    size = 0;\r\n\r\n                if(!$(this).closest(IPPR.dom.lists.extra).size()){\r\n\r\n                    if (IPPR.states.view === 'companies') {\r\n                        IPPR.states.highlight = 'companies';\r\n                    } else if (IPPR.states.view === 'mines') {\r\n                        IPPR.states.highlight = 'mines';\r\n                    } else {\r\n                        IPPR.states.highlight = 'minerals';\r\n                    }\r\n\r\n\r\n                    if(IPPR.states.desktop){\r\n\r\n                        if(IPPR.states.view === 'mines'){\r\n                            IPPR.displayAdditionalInfo($(this), 'mine');\r\n                        } else if(IPPR.states.view === 'minerals'){\r\n                            IPPR.displayAdditionalInfo($(this), 'minerals');\r\n                        } else {\r\n                            IPPR.displayAdditionalInfo($(this), 'company');\r\n                        }\r\n\r\n                    } else {\r\n                        $(this).closest(IPPR.dom.lists.holder).addClass(IPPR.states.hidden);\r\n                        if(IPPR.states.view !== 'mines'){\r\n                            IPPR.displayAdditionalInfo($(this), 'company');\r\n                        }\r\n                    }\r\n\r\n                    var companies = [],\r\n                        minerals = [];\r\n\r\n                    $.each(IPPR.data.data[key][id], function(k, company){\r\n\r\n                        if (IPPR.states.view === 'companies'){\r\n                            companies.push(company);\r\n                        } else if (IPPR.states.view === 'minerals') {\r\n                            minerals.push(company);\r\n                        } else {\r\n\r\n                            Mustache.parse(mustacheTpl[key]);\r\n\r\n                            markup[key] += Mustache.render(\r\n                                mustacheTpl[key], {\r\n                                    active: key <= 2 ? true : false,\r\n                                    companyInfo: company\r\n                                }\r\n                            );\r\n\r\n                        }\r\n\r\n                        size++;\r\n\r\n                    });\r\n\r\n                    if (IPPR.states.view === 'companies'){\r\n\r\n                        $.each(IPPR.helpers.groupBy(companies, 'mine_id'), function(k, value){\r\n\r\n                            Mustache.parse(mustacheTpl[key]);\r\n\r\n                            markup[key] += Mustache.render(\r\n                                mustacheTpl[key], {\r\n                                    mine_name: k,\r\n                                    minesInfo: value[0]\r\n                                }\r\n                            );\r\n\r\n                        });\r\n\r\n                        if (IPPR.states.mobile){\r\n                            $.each(IPPR.map.markers[key], function(index, val) {\r\n                                 val.off('click');\r\n                            });\r\n\r\n                            $.each(IPPR.map.layers[key], function(index, val) {\r\n                                 val.off('click');\r\n                            });\r\n\r\n                            $.each(IPPR.map.map, function(k,v){\r\n                                v.dragging.disable();\r\n                            });\r\n\r\n                        }\r\n                    }\r\n\r\n\r\n                    if (IPPR.states.view === 'minerals'){\r\n\r\n                        $.each(IPPR.helpers.groupBy(minerals, 'mineral'), function(k, value){\r\n\r\n                            Mustache.parse(mustacheTpl[key]);\r\n\r\n                            markup[key] += Mustache.render(\r\n                                mustacheTpl[key], {\r\n                                    mine_name: k,\r\n                                    minesInfo: value\r\n                                }\r\n                            );\r\n\r\n                        });\r\n\r\n                        if (IPPR.states.mobile){\r\n                            $.each(IPPR.map.markers[key], function(index, val) {\r\n                                 val.off('click');\r\n                            });\r\n\r\n                            $.each(IPPR.map.layers[key], function(index, val) {\r\n                                 val.off('click');\r\n                            });\r\n\r\n                            $.each(IPPR.map.map, function(k,v){\r\n                                v.dragging.disable();\r\n                            });\r\n\r\n                        }\r\n                    }\r\n\r\n\r\n\r\n                    $('#tab-'+key).find(IPPR.dom.lists.extra).removeClass(IPPR.states.hidden);\r\n                    $('#tab-'+key).find(IPPR.dom.lists.extra).find(IPPR.dom.lists.list).html(markup[key]);\r\n                    $('#tab-'+key).find(IPPR.dom.lists.extra).find(IPPR.dom.lists.count).html('('+size+')');\r\n\r\n                    $('#tab-'+key).find(IPPR.dom.lists.headerActive).removeClass(IPPR.states.hidden);\r\n                    $('#tab-'+key).find(IPPR.dom.lists.headerInActive).addClass(IPPR.states.hidden);\r\n\r\n                    IPPR.map.map[key].invalidateSize();\r\n\r\n                } else {\r\n                    IPPR.states.highlight = 'mines';\r\n                }\r\n\r\n                \r\n                if(IPPR.states.desktop){\r\n                    if (key === '1'){\r\n                        IPPR.map.highlightLayer('2',id);\r\n                    } else if(key === '2'){\r\n                        IPPR.map.highlightLayer('4', id);    \r\n                    } else {\r\n                        IPPR.map.highlightLayer(key,id);\r\n                    }\r\n                } else {\r\n                    IPPR.map.highlightLayer(key,id);\r\n                }\r\n\r\n                $('.collapsible').collapsible({\r\n                    accordion : true\r\n                });\r\n\r\n            });\r\n\r\n        });\r\n\r\n    };\r\n\r\n\r\n    IPPR.filtering = function(){\r\n\r\n        $.each(IPPR.data.tabs, function(key){\r\n            IPPR.filters.list.push(new List('tab-'+key, IPPR.filters.options));// jshint ignore:line\r\n\r\n            $('#tab-'+key).find(IPPR.dom.filters.item).on('click', function() {\r\n\r\n                IPPR.states.filters = true;\r\n\r\n                if ($(this).is('.'+IPPR.states.active)){\r\n                    IPPR.filters.list[key].filter();\r\n                    $(this).closest(IPPR.dom.filters.main).find('.chip').removeClass(IPPR.states.active);\r\n                    if(IPPR.states.mobile){\r\n                        IPPR.filters.clear();\r\n                        IPPR.map.resetLayers();\r\n                    }\r\n                } else {\r\n\r\n                    var value = $(this).data('filter');\r\n\r\n                    $(this).closest(IPPR.dom.filters.main).find('.chip').removeClass(IPPR.states.active);\r\n                    $(this).addClass(IPPR.states.active);\r\n\r\n                    if(IPPR.states.mobile){\r\n                        IPPR.dom.filters.search.addClass(IPPR.states.hidden);\r\n                        var clone = $(this).clone();\r\n                        IPPR.dom.filters.activeHolder.html(clone);\r\n                    }\r\n\r\n                    IPPR.filters.list[key].filter(function (item) {\r\n                        if (item.values()[value]){\r\n                            return true;\r\n                        }\r\n                        return false;\r\n                    });\r\n\r\n                    IPPR.map.searchLayers(IPPR.states.view);\r\n                }\r\n            });\r\n\r\n\r\n        });\r\n\r\n\r\n        $.each(IPPR.filters.list, function(index, val) {\r\n            val.on('updated', function(){\r\n                IPPR.map.searchLayers(IPPR.states.view);\r\n            });\r\n        });\r\n\r\n        $('.'+IPPR.filters.options.searchClass).on('keyup', function(){\r\n            if ($(this).val()){\r\n                IPPR.states.filters = true;\r\n                IPPR.dom.filters.searchTrigger.addClass(IPPR.states.hidden);\r\n                IPPR.dom.filters.searchRemove.addClass(IPPR.states.visible);\r\n            } else {\r\n                IPPR.states.filters = false;\r\n                IPPR.dom.filters.searchTrigger.removeClass(IPPR.states.hidden);\r\n                IPPR.dom.filters.searchRemove.removeClass(IPPR.states.visible);\r\n            }\r\n        });\r\n\r\n\r\n        IPPR.dom.filters.searchRemove.on('click', function(){\r\n            IPPR.map.resetLayers();\r\n            $('.'+IPPR.filters.options.searchClass).val('').trigger('keyup').blur();\r\n            $.each(IPPR.filters.list, function(k){\r\n                IPPR.filters.list[k].search();\r\n            });\r\n            IPPR.states.filters = false;\r\n            IPPR.dom.filters.searchTrigger.removeClass(IPPR.states.hidden);\r\n            IPPR.dom.filters.searchRemove.removeClass(IPPR.states.visible);\r\n            $(IPPR.dom.lists.main+':visible').find('.collection-item').removeClass(IPPR.states.active);\r\n        });\r\n\r\n\r\n        if(IPPR.states.mobile){\r\n            IPPR.dom.filters.activeHolder.on('click', '.chip', function(){\r\n                IPPR.filters.clear();\r\n                IPPR.map.resetLayers();\r\n            });\r\n        }\r\n    };\r\n\r\n\r\n    IPPR.mapTrigger = function(){\r\n\r\n        IPPR.dom.mapTrigger.on('click', function(e){\r\n            e.preventDefault();\r\n\r\n            if (IPPR.states.mobile){\r\n                $(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).toggleClass(IPPR.states.hidden);\r\n            }\r\n\r\n            IPPR.dom.map.toggleClass(IPPR.states.visible);\r\n\r\n            $.each(IPPR.map.map, function(key,value){\r\n                if(value){\r\n                    value.invalidateSize();\r\n                    value.dragging.enable();\r\n                }\r\n            });\r\n\r\n            if($(IPPR.dom.lists.main).find(IPPR.dom.lists.holder).is('.'+IPPR.states.hidden) || IPPR.dom.dataHolder.is('.'+IPPR.states.hidden)){\r\n                IPPR.states.map = true;\r\n                $(this).find('.material-icons').html('view_list');\r\n            } else {\r\n                $(this).find('.material-icons').html('map');\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    IPPR.initApp = function(){\r\n        if(U.vw() < 993){\r\n            if (!IPPR.states.mobile){\r\n                IPPR.mobile();\r\n            }\r\n        } else {\r\n            if (!IPPR.states.desktop){\r\n                IPPR.desktop();\r\n            }\r\n        }\r\n\r\n        IPPR.listDetails();\r\n    };\r\n\r\n\r\n\r\n\r\n\r\n\r\n    IPPR.sankey = function(sankeyData, sankeyElem){\r\n\r\n\r\n        var _self = {\r\n            draw: function(){\r\n\r\n                var data = new google.visualization.DataTable();\r\n\r\n                data.addColumn('string', 'From');\r\n                data.addColumn('string', 'To');\r\n                data.addColumn('number', '');\r\n                data.addColumn({type:'string', role:'tooltip'});\r\n                data.addRows(sankeyData);\r\n\r\n                var colors = ['#7E9669', '#256A9A'];\r\n\r\n                // Sets chart options.\r\n                var options = {\r\n                    width: '100%',\r\n                    height: 400,\r\n                    sankey: {\r\n                        node: {\r\n                            colors: colors,\r\n                            width: 5,\r\n                            nodePadding: 150\r\n                        },\r\n                        link: {\r\n                            colorMode: 'gradient',\r\n                            colors: colors\r\n                        }\r\n                    }\r\n                };\r\n\r\n                // Instantiates and draws our chart, passing in some options.\r\n                var chart = new google.visualization.Sankey(document.querySelector(sankeyElem));\r\n\r\n                chart.draw(data, options);\r\n            }\r\n        };\r\n\r\n        _self.draw();\r\n\r\n        // google.charts.setOnLoadCallback(_self.draw);\r\n\r\n        U.addEvent(window, 'resize', U.debounce(function () {\r\n            _self.draw();\r\n        }, 200));\r\n\r\n    };\r\n\r\n\r\n\r\n\r\n    if ($('body').is('.App')){\r\n\r\n        IPPR.getData();\r\n        IPPR.initMap();\r\n        IPPR.initApp();\r\n        IPPR.mapTrigger();\r\n        U.addEvent(window, 'resize', U.debounce(function () {\r\n            IPPR.initApp();\r\n        }, 200));\r\n\r\n\r\n        if (window.location.hash){\r\n            $('.Header-tabs a[href=\"/'+window.location.hash+'\"]').click();\r\n        }\r\n\r\n    }\r\n\r\n\r\n\r\n    $('.js-dropdown-trigger').dropdown({\r\n        inDuration: 300,\r\n        outDuration: 225,\r\n        constrain_width: false, // Does not change width of dropdown to that of the activator\r\n        hover: false, // Activate on hover\r\n        gutter: 0, // Spacing from edge\r\n        belowOrigin: true, // Displays dropdown below the button\r\n        alignment: 'right' // Displays dropdown with edge aligned to the left of button\r\n    });\r\n\r\n\r\n})(window.burza.utils, jQuery);\r\n"]}