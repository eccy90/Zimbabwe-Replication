"use strict";!function(a,b){function c(a,b,d){var f,g,h,i,j,k,l=b.length;for(f=0;f<l;f++)if(h=b[f],e.is.object(h)||e.is["function"](h))for(i=e.keys(h),j=i.length,g=0;g<j;g++){k=i[g];var m=h[k];d&&e.is.object(m)?e.is.date(m)?a[k]=new Date(m.valueOf()):e.is.regExp(m)?a[k]=new RegExp(m):(e.is.object(a[k])||(a[k]=e.is.array(m)?[]:{}),c(a[k],m,!0)):a[k]=m}return a}var d={},e={};e.EMAIL_REGEXP=/^[A-Za-z0-9](([_\.\-\+]?[a-zA-Z0-9_]+)*)@([A-Za-z0-9]+)(([\.\-]?[a-zA-Z0-9]+)*)\.([A-Za-z]{2,})$/,d.eventType=function(a){return a.addEventListener&&a.removeEventListener?1:a.attachEvent&&a.detachEvent?2:0}(a),e.createElement=function(b){return a.document.createElement(b)},e.getElement=function(b,c){return 1===arguments.length&&(c=b,b=a.document),b.querySelector(c)},e.getElements=function(b,c){return 1===arguments.length&&(c=b,b=a.document),b.querySelectorAll(c)},e.addEvent=function(a,b,c){a&&(1===d.eventType?a.addEventListener(b,c,!1):2===d.eventType?a.attachEvent("on"+b,c):a["on"+b]=c)},e.removeEvent=function(a,b,c){1===d.eventType?a.removeEventListener(b,c,!1):2===d.eventType?a.detachEvent("on"+b,c):a["on"+b]===c&&(a["on"+b]=null)},e.hasClass=function(a,b){return a.classList?a.classList.contains(b):(" "+a.className+" ").indexOf(" "+b+" ")>=0},e.addClass=function(a,b){e.hasClass(a,b)||(a.classList?a.classList.add(b):a.className+=" "+b)},e.removeClass=function(a,b){return a.classList?a.classList.remove(b):(a.className=a.className.replace(new RegExp("(^|\\b)"+b+"(\\b|$)","g")," "),a.className)},e.toggleClass=function(a,b,c){return c===!0?e.addClass(a,b):c===!1?e.removeClass(a,b):e.toggleClass(a,b,e.hasClass(a,b))},e.forEach=function(a,b){var c,d=a.length;for(c=0;c<d;c++)b(a[c],c,a)},e.map=function(a,b){var c,d=[],e=a.length;for(c=0;c<e;c++)d.push(b(a[c],c,a));return d},e.noop=function(){},e.is={defined:function(a){return"undefined"!=typeof a},undefined:function(a){return"undefined"==typeof a},"boolean":function(a){return"boolean"==typeof a},string:function(a){return"string"==typeof a},number:function(a){return"number"==typeof a},array:function(a){return Array.isArray(a)},object:function(a){return null!==a&&"object"==typeof a},"function":function(a){return"function"==typeof a},date:function(a){var b=Object.prototype.toString;return"[object Date]"===b.call(a)},regExp:function(a){var b=Object.prototype.toString;return"[object RegExp]"===b.call(a)}},e.keys=function(a){return Object.keys(a)},e.extend=function(a){return c(a,[].slice.call(arguments,1),!1)},e.merge=function(a){return c(a,[].slice.call(arguments,1),!0)},e.debounce=function(b,c){c=c||250;var d=null;return function(){var e=this,f=arguments;a.clearTimeout(d),d=a.setTimeout(function(){b.apply(e,f)},c)}},e.throttle=function(b,c,d){c=c||250;var e,f;return function(){var g=d||this,h=+new Date,i=arguments;e&&h<e+c?(a.clearTimeout(f),f=a.setTimeout(function(){e=h,b.apply(g,i)},c)):(e=h,b.apply(g,i))}},e.raf=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||a.oRequestAnimationFrame||function(b){a.setTimeout(b,1e3/60)},e.getScroll=function(){return a.pageYOffset||a.document.body.scrollTop||a.document.documentElement.scrollTop||0},e.vw=function(){return a.innerWidth||a.document.documentElement.clientWidth||a.document.body.clientWidth||0},e.vh=function(){return a.innerHeight||a.document.documentElement.clientHeight||a.document.body.clientHeight||0},e.getScrollbarWidth=function(){var a=document.createElement("div");a.style.position="absoute",a.style.top="-9999px",a.style.width="50px",a.style.height="50px",a.style.overflow="scroll",e.getElement("body").appendChild(a);var b=a.offsetWidth-a.clientWidth;return e.getElement("body").removeChild(a),b},e.serialize=function(a){var b,c=[];if("object"==typeof a&&"FORM"===a.nodeName)for(var d=a.elements.length,e=0;e<d;e++)if(b=a.elements[e],b.name&&!b.disabled&&"file"!==b.type&&"reset"!==b.type&&"submit"!==b.type&&"button"!==b.type)if("select-multiple"===b.type)for(var f=a.elements[e].options.length-1;f>=0;f--)b.options[f].selected&&(c[c.length]=encodeURIComponent(b.name)+"="+encodeURIComponent(b.options[f].value));else("checkbox"!==b.type&&"radio"!==b.type||b.checked)&&(c[c.length]=encodeURIComponent(b.name)+"="+encodeURIComponent(b.value));return c.join("&").replace(/%20/g,"+")},e.ajax=function(b,c,d,e){c="undefined"!=typeof c?c:"GET";var f;if(a.XMLHttpRequest)f=new XMLHttpRequest;else if(a.ActiveXObject)try{f=new ActiveXObject("Msxml2.XMLHTTP")}catch(g){try{f=new ActiveXObject("Microsoft.XMLHTTP")}catch(g){}}"undefined"!=typeof d&&null!==d&&(b=b+"?"+d),f.open(c,b,!0),f.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"===c?(f.setRequestHeader("Content-type","application/x-www-form-urlencoded"),f.send(d)):(f.setRequestHeader("X-Requested-With","XMLHttpRequest"),f.send()),f.onreadystatechange=function(){4===f.readyState&&e(f)}},a[b]=a[b]||{},a[b].utils=e}(window,"burza"),function(a,b){Array.from||(Array.from=function(a){return[].slice.call(a)});var c={dom:{header:b(".Header"),data:b(".Data"),lists:{main:".List--main",extra:".List--extra",info:".List--info",count:".List-count",header:".List-header",holder:".List-holder",title:".List-title",list:".collection",infoName:".List-infoName",headerActive:".List-headerActive",headerInActive:".List-headerInactive","switch":".List-switch"},content:b(".Content"),tabs:b(".Header-tabs a"),levels:b("div[data-level]"),dataHolder:b(".Data-holder"),filters:{main:".Filters",mobile:".Filters--mobile",item:".Filters .chip",trigger:b(".Filters-trigger"),activeHolder:b(".Filters-active"),remove:b("Filters-remove"),search:b(".Search-field"),searchRemove:b(".Search-remove"),searchTrigger:b(".Search-trigger")},map:b(".Map"),mapTrigger:b(".Map-trigger"),mapInline:b(".Map--inline"),showInfo:".js-showAdditionalInfo",sankey:{mobile:".Sankey-mobile",desktop:".Sankey-desktop"},additionalInfo:b(".AdditionalInfo"),additionalInfoTitle:b(".AdditionalInfo-title"),additionalInfoHeader:b(".AdditionalInfo-header"),footer:b(".Footer"),templates:{main:".main-tpl",extra:".extra-tpl",licenceTable:".licenceTable-tpl",companyTable:".companyTable-tpl",ownedLicenses:".ownedLicenses-tpl",hierarchy:".hierarchy-tpl"},additionalInfoStrings:{licence:"Transaction history for Licence number <span></span>",company:"Additional information"},ownedLicenses:".OwnedLicenses",hierarchy:".Hierarchy",table:".Table"},states:{loading:"is-loading",active:"is-active",animate:"has-animation",hidden:"u-isHidden",visible:"is-visible",selected:"is-selected",mobile:!1,desktop:!1,view:"licenses",hightlight:"licenses",map:!1,filters:!1},data:{apiURL:"https://miningpachena.carto.com/api/v2/sql/?q=",data:{},tabs:{0:{name:"companies",sql:"SELECT *, cartodb_id as company_id, name as company_name FROM zw_companies",groupBy:"company_id"},1:{name:"mines",sql:"SELECT * FROM zw_mines",groupBy:"cartodb_id"},2:{name:"minerals",sql:"SELECT cartodb_id AS mineral_id, name FROM zw_minerals ORDER BY name ASC",groupBy:"mineral_id"}}},map:{map:[],layers:[],markers:[],styles:{"default":{weight:1,fill:!0,fillColor:"#5E8FB1",dashArray:"",color:"#000",fillOpacity:1},active:{weight:2,fill:!0,fillColor:"#256A9A",dashArray:"",color:"#000",fillOpacity:1},filtered:{weight:3,fill:!0,fillColor:"#93B4CB",dashArray:"",color:"transparent",fillOpacity:1}},highlightLayer:function(a,d){b.each(c.map.layers[a],function(e,f){c.states.filters||(c.map.layers[a][e].setStyle(c.map.styles["default"]),b(c.map.markers[a][e]._icon).removeClass(c.states.active),b(c.map.markers[a][e]._icon).removeClass(c.states.selected),c.map.layers[a][e].isActive=!1,c.map.markers[a][e].isActive=!1),("licenses"===c.states.highlight&&f.ID===d||"companies"===c.states.highlight&&f.company_id===d)&&(c.map.layers[a][e].setStyle(c.map.styles.active),c.map.layers[a][e].bringToFront(),c.map.layers[a][e].isActive=!0,c.map.markers[a][e].isActive=!0,b(c.map.markers[a][e]._icon).addClass(c.states.selected),c.states.mobile&&setTimeout(function(){c.map.markers[a][e]._latlng.lat&&c.map.markers[a][e]._latlng.lng&&c.map.map[a].setView(new L.LatLng(c.map.markers[a][e]._latlng.lat,c.map.markers[a][e]._latlng.lng),6)},200))})},resetLayers:function(){b.each(c.map.layers,function(a,d){b.each(d,function(d){c.map.layers[a][d].setStyle(c.map.styles["default"]),b(c.map.markers[a][d]._icon).removeClass(c.states.active),b(c.map.markers[a][d]._icon).removeClass(c.states.selected)})})},searchLayers:function(a){c.states.filters||c.map.resetLayers();var d="licenses"===a?0:2,e=b(c.dom.lists.main+":visible").find(".collection-item"),f=[];b.each(e,function(a,c){f.push(b(c).data("id"))}),b.each(c.map.layers[d],function(a,e){"licenses"===c.states.view&&b.inArray(e.ID,f)<0||"companies"===c.states.view&&b.inArray(e.company_id,f)<0?(c.map.layers[d][a].setStyle(c.map.styles.filtered),b(c.map.markers[d][a]._icon).removeClass(c.states.active),b(c.map.markers[d][a]._icon).removeClass(c.states.selected),c.map.layers[d][a].isActive=!1,c.map.markers[d][a].isActive=!1):(b(c.map.markers[d][a]._icon).removeClass(c.states.selected),c.map.layers[d][a].isActive=!0,c.map.markers[d][a].isActive=!0)});var g=b(c.dom.lists.main+":visible").find(".collection-item").size();b(c.dom.lists.main).find(c.dom.lists.count).html("("+g+")")}},filters:{list:[],options:{valueNames:["List-title","concessionNumbers","expiration"],listClass:"collection",searchClass:"Search-input"},clear:function(){b.each(c.filters.list,function(a){c.filters.list[a].filter()}),b(c.dom.filters.item).removeClass(c.states.active),c.dom.filters.search.removeClass(c.states.hidden),c.dom.filters.activeHolder.empty()}},helpers:{groupBy:function(a,b){return a.reduce(function(a,c){return(a[c[b]]=a[c[b]]||[]).push(c),a},{})},unique:function(a,b,c){return c.indexOf(a)===b}}};google.charts.load("current",{packages:["sankey"]}),c.loading=function(){c.dom.data.toggleClass(c.states.loading)},c.getData=function(){var a,d,e=[],f=[],g=!1;b.each(c.data.tabs,function(h,i){e[h]="",f[h]=b("#tab-"+h).find(c.dom.templates.main).html(),b.getJSON(c.data.apiURL+i.sql,function(j){c.data.data[h]=c.helpers.groupBy(j.rows,i.groupBy),b.each(c.data.data[h],function(c,j){var k="",l="";b.each(j,function(a,b){l=a+1<j.length?",":"",k+=b.concessions+l}),Mustache.parse(f[h]),"companies"===i.name?(a=j[0].company_name,d=j[0].company_id):"minerals"===i.name?(a=j[0].name,d=j[0].mineral_id):(a=j[0].name,d=j[0].cartodb_id),e[h]+=Mustache.render(f[h],{title:a,id:d,expiration:g,concessionNumbers:!!k&&k.split(",")})}),b("#tab-"+h).find(c.dom.lists.main).find(c.dom.lists.list).html(e[h]),b("#tab-"+h).find(c.dom.lists.main).find(c.dom.lists.count).html("("+Object.keys(c.data.data[h]).length+")"),Object.keys(c.data.tabs).length-1===parseInt(h)&&(c.loading(),setTimeout(function(){c.filtering()},300))})})},c.initMap=function(){b.getJSON("/data/zm_mines.geojson",function(a){b.each(c.dom.map,function(d,e){function f(a,e){function f(){c.states.filters&&c.map.searchLayers(c.states.view),this.isActive||c.dom.filters.searchRemove.click();var d,e;g.is(".licenses")?(d=b(c.dom.lists.main).find('li[data-id="'+a.properties.license_id+'"]'),d.click(),e=d.position().top,b(c.dom.lists.main).find(c.dom.lists.holder).scrollTop(e)):g.is(".companies")&&(d=b(c.dom.lists.main).find('li[data-id="'+a.properties.operator_id+'"]'),d.click(),e=d.position().top,b(c.dom.lists.main).find(c.dom.lists.holder).scrollTop(e))}b.each(a.properties,function(a,b){e[a]=b}),e.ID=a.properties.license_id,e.company_id=a.properties.operator_id,console.log(e),c.map.layers[d].push(e);var h=L.marker(e._latlng,{icon:L.divIcon({className:"Map-label",html:"<span>"+e.number+"</span>"})}).addTo(c.map.map[d]);c.map.markers[d].push(h),h.on("click",f),e.on("click",f)}var g=b(e);c.map.layers[d]=[],c.map.markers[d]=[],c.map.map[d]=L.map(b(".Map").eq(d)[0],{scrollWheelZoom:!1,zoomControl:!1}).setView([-18.997,20.908],6),L.control.zoom({position:"bottomright"}).addTo(c.map.map[d]),L.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}@2x.png",{maxZoom:18}).addTo(c.map.map[d]),L.geoJson([a],{style:c.map.styles["default"],onEachFeature:f}).addTo(c.map.map[d])})})},b(document).on("click",c.dom.lists["switch"],function(){var a=b(this).data("id"),d=b(this).data("to");c.states.view=d,b('a[data-view="'+d+'"]').click(),b('.collection-item[data-id="'+a+'"]').click();var e=b('.collection-item[data-id="'+a+'"]').position().top;b(c.dom.lists.main).find(c.dom.lists.holder).scrollTop(e)}),c.displayAdditionalInfo=function(a,d){var e,f,g,h,i,j;"licence"===d?(b(c.dom.additionalInfoTitle).html(c.dom.additionalInfoStrings[d]),b(c.dom.additionalInfoHeader).removeClass("green").addClass("blue"),f=a.find(c.dom.lists.title).html(),g=b(c.dom.templates.licenceTable).html(),Mustache.parse(g),c.dom.additionalInfo.find(c.dom.ownedLicenses).addClass(c.states.hidden),c.dom.additionalInfo.find(c.dom.hierarchy).addClass(c.states.hidden),c.states.mobile?(b(c.dom.lists.info).find(c.dom.lists.infoName).html(f),c.dom.additionalInfo.addClass(c.states.hidden)):(c.dom.additionalInfo.removeClass(c.states.hidden),c.dom.additionalInfo.find(".AdditionalInfo-title span").html(f),b(c.dom.sankey.desktop).removeClass(c.states.hidden))):(b(c.dom.additionalInfoTitle).html(c.dom.additionalInfoStrings[d]),b(c.dom.additionalInfoHeader).removeClass("blue").addClass("green"),b(c.dom.sankey.desktop).addClass(c.states.hidden),c.dom.additionalInfo.removeClass(c.states.hidden),e=c.data.data[1][a.data("id")][0],g=b(c.dom.templates.companyTable).html(),i=b(c.dom.templates.hierarchy).html(),Mustache.parse(g),Mustache.parse(i),h=Mustache.render(g,{tableRows:e}),b.getJSON("https://namibmap.carto.com/api/v2/sql/?q=SELECT * FROM na_people WHERE company_id = "+a.data("id"),function(a){j=Mustache.render(i,{hierarchy:a.rows}),c.states.mobile?b(c.dom.lists.extra).find(c.dom.hierarchy).html(j):c.dom.additionalInfo.find(c.dom.hierarchy).html(j).removeClass(c.states.hidden)}),c.states.mobile?(b(c.dom.lists.extra).find(c.dom.table).html(h),c.dom.additionalInfo.addClass(c.states.hidden)):(c.dom.additionalInfo.removeClass(c.states.hidden),c.dom.additionalInfo.find(c.dom.table).html(h).removeClass(c.states.hidden)))},c.mobile=function(){c.states.desktop=!1,c.dom.tabs.off("click.mobile"),c.dom.tabs.on("click.mobile",function(){c.states.filters=!1,c.dom.filters.searchTrigger.removeClass(c.states.hidden),c.dom.filters.searchRemove.removeClass(c.states.visible),c.dom.filters.searchRemove.click(),c.filters.clear(),setTimeout(function(){c.dom.footer.addClass(c.states.hidden)},400),c.map.resetLayers(),c.dom.content.addClass(c.states.active),setTimeout(function(){c.dom.content.addClass(c.states.animate),b.each(c.map.map,function(a,b){b&&b.invalidateSize()})},100),c.states.view=b(this).data("view"),"licenses"===c.states.view?c.dom.mapTrigger.addClass(c.states.active):(c.dom.map.removeClass(c.states.visible),b(c.dom.lists.main).find(c.dom.lists.holder).removeClass(c.states.hidden),c.dom.mapTrigger.find(".material-icons").html("map"))}),b.each(c.dom.levels,function(a,d){var e=b(this).data("level");b(d).find(c.dom.lists.header).off("click"),b(d).find(c.dom.lists.header).on("click",function(){0===e?(c.dom.footer.removeClass(c.states.hidden),c.dom.content.removeClass(c.states.animate),setTimeout(function(){c.dom.content.removeClass(c.states.active)},100),c.dom.mapTrigger.removeClass(c.states.active)):1===e?(c.dom.dataHolder.css({transform:"translate(0,0)"}),"licenses"===c.states.view&&c.dom.mapTrigger.addClass(c.states.active),c.dom.map.removeClass(c.states.hidden),b.each(c.map.map,function(a,b){b&&b.invalidateSize()}),b(c.dom.lists.extra).addClass(c.states.hidden),b(c.dom.lists.info).addClass(c.states.hidden),"map"===c.dom.mapTrigger.find(".material-icons").html()&&b(c.dom.lists.main).find(c.dom.lists.holder).removeClass(c.states.hidden)):2===e&&c.dom.dataHolder.css({transform:"translate(-33.3333%,0)"})})}),b(document).on("click",c.dom.showInfo,function(a){a.preventDefault();var d=b(this).closest(c.dom.dataHolder).find(".collection-item.is-active");c.displayAdditionalInfo(d,"licence"),b(c.dom.lists.info).removeClass(c.states.hidden),c.dom.dataHolder.css({transform:"translate(-66.6666%,0)"}),b(window).scrollTop(0)}),c.states.mobile=!0},c.desktop=function(){c.states.mobile=!1,c.dom.tabs.off("click.desktop"),b(c.dom.lists.extra).removeClass(c.states.hidden),c.dom.tabs.on("click.desktop",function(){c.states.filters=!1,c.dom.filters.searchTrigger.removeClass(c.states.hidden),c.dom.filters.searchRemove.removeClass(c.states.visible),c.dom.filters.searchRemove.click(),c.filters.clear(),c.map.resetLayers(),setTimeout(function(){b.each(c.map.map,function(a,b){b&&b.invalidateSize()})},100),c.states.view=b(this).data("view"),c.dom.additionalInfo.addClass(c.states.hidden)}),b.each(c.map.map,function(a,b){b.dragging.enable()}),c.states.desktop=!0},c.listDetails=function(){var a=[],d=[];b.each(c.data.tabs,function(e){d[e]=b("#tab-"+e).find(".extra-tpl").html(),b("#tab-"+e).on("click",".collection-item",function(){c.states.filters&&c.map.searchLayers(c.states.view),a[e]="",c.dom.mapTrigger.removeClass(c.states.active),b(this).parent().find("li").removeClass(c.states.active),b(this).addClass(c.states.active),c.states.mobile?(c.dom.dataHolder.css({transform:"translate(-33.3333%,0)"}),"licenses"===c.states.view?c.dom.map.addClass(c.states.hidden):c.dom.mapInline.removeClass(c.states.hidden),b(window).scrollTop(0)):c.dom.map.removeClass(c.states.hidden);var f=b(this).data("id"),g=0;if(b(this).closest(c.dom.lists.extra).size())c.states.highlight="licenses";else{"companies"===c.states.view?c.states.highlight="companies":c.states.highlight="licenses",c.states.desktop?"licenses"===c.states.view?c.displayAdditionalInfo(b(this),"licence"):c.displayAdditionalInfo(b(this),"company"):(b(this).closest(c.dom.lists.holder).addClass(c.states.hidden),"licenses"!==c.states.view&&c.displayAdditionalInfo(b(this),"company"));var h=[];b.each(c.data.data[e][f],function(b,f){"companies"===c.states.view?h.push(f):(Mustache.parse(d[e]),a[e]+=Mustache.render(d[e],{active:e<=2,companyInfo:f})),g++}),"companies"===c.states.view&&(g=0,b.each(c.helpers.groupBy(h,"license_number"),function(c,f){var h="",i="";b.each(f,function(a,b){i=a+1<f.length?",":"",h+=b.concessions+i}),Mustache.parse(d[e]),a[e]+=Mustache.render(d[e],{title:c,id:f[0].license_id,concessionNumbers:!!h&&h.split(",")}),g++}),c.states.mobile&&(b.each(c.map.markers[e],function(a,b){b.off("click")}),b.each(c.map.layers[e],function(a,b){b.off("click")}),b.each(c.map.map,function(a,b){b.dragging.disable()}))),b("#tab-"+e).find(c.dom.lists.extra).removeClass(c.states.hidden),b("#tab-"+e).find(c.dom.lists.extra).find(c.dom.lists.list).html(a[e]),b("#tab-"+e).find(c.dom.lists.extra).find(c.dom.lists.count).html("("+g+")"),b("#tab-"+e).find(c.dom.lists.headerActive).removeClass(c.states.hidden),b("#tab-"+e).find(c.dom.lists.headerInActive).addClass(c.states.hidden),c.map.map[e].invalidateSize()}c.states.desktop&&"1"===e?c.map.highlightLayer("2",f):c.map.highlightLayer(e,f),b(".collapsible").collapsible({accordion:!0})})})},c.filtering=function(){b.each(c.data.tabs,function(a){c.filters.list.push(new List("tab-"+a,c.filters.options)),b("#tab-"+a).find(c.dom.filters.item).on("click",function(){if(c.states.filters=!0,b(this).is("."+c.states.active))c.filters.list[a].filter(),b(this).closest(c.dom.filters.main).find(".chip").removeClass(c.states.active),c.states.mobile&&(c.filters.clear(),c.map.resetLayers());else{var d=b(this).data("filter");if(b(this).closest(c.dom.filters.main).find(".chip").removeClass(c.states.active),b(this).addClass(c.states.active),c.states.mobile){c.dom.filters.search.addClass(c.states.hidden);var e=b(this).clone();c.dom.filters.activeHolder.html(e)}c.filters.list[a].filter(function(a){return!!a.values()[d]}),c.map.searchLayers(c.states.view)}})}),b.each(c.filters.list,function(a,b){b.on("updated",function(){c.map.searchLayers(c.states.view)})}),b("."+c.filters.options.searchClass).on("keyup",function(){b(this).val()?(c.states.filters=!0,c.dom.filters.searchTrigger.addClass(c.states.hidden),c.dom.filters.searchRemove.addClass(c.states.visible)):(c.states.filters=!1,c.dom.filters.searchTrigger.removeClass(c.states.hidden),c.dom.filters.searchRemove.removeClass(c.states.visible))}),c.dom.filters.searchRemove.on("click",function(){c.map.resetLayers(),b("."+c.filters.options.searchClass).val("").trigger("keyup").blur(),b.each(c.filters.list,function(a){c.filters.list[a].search()}),c.states.filters=!1,c.dom.filters.searchTrigger.removeClass(c.states.hidden),c.dom.filters.searchRemove.removeClass(c.states.visible),b(c.dom.lists.main+":visible").find(".collection-item").removeClass(c.states.active)}),c.states.mobile&&c.dom.filters.activeHolder.on("click",".chip",function(){c.filters.clear(),c.map.resetLayers()})},c.mapTrigger=function(){c.dom.mapTrigger.on("click",function(a){a.preventDefault(),c.states.mobile&&b(c.dom.lists.main).find(c.dom.lists.holder).toggleClass(c.states.hidden),c.dom.map.toggleClass(c.states.visible),b.each(c.map.map,function(a,b){b&&(b.invalidateSize(),b.dragging.enable())}),b(c.dom.lists.main).find(c.dom.lists.holder).is("."+c.states.hidden)||c.dom.dataHolder.is("."+c.states.hidden)?(c.states.map=!0,b(this).find(".material-icons").html("view_list")):b(this).find(".material-icons").html("map")})},c.initApp=function(){a.vw()<993?c.states.mobile||c.mobile():c.states.desktop||c.desktop(),c.listDetails()},c.sankey=function(b,c){var d={draw:function(){var a=new google.visualization.DataTable;a.addColumn("string","From"),a.addColumn("string","To"),a.addColumn("number",""),a.addColumn({type:"string",role:"tooltip"}),a.addRows(b);var d=["#7E9669","#256A9A"],e={width:"100%",height:400,sankey:{node:{colors:d,width:5,nodePadding:150},link:{colorMode:"gradient",colors:d}}},f=new google.visualization.Sankey(document.querySelector(c));f.draw(a,e)}};d.draw(),a.addEvent(window,"resize",a.debounce(function(){d.draw()},200))},b("body").is(".App")&&(c.getData(),c.initMap(),c.initApp(),c.mapTrigger(),a.addEvent(window,"resize",a.debounce(function(){c.initApp()},200)),window.location.hash&&b('.Header-tabs a[href="/'+window.location.hash+'"]').click()),b(".js-dropdown-trigger").dropdown({inDuration:300,outDuration:225,constrain_width:!1,hover:!1,gutter:0,belowOrigin:!0,alignment:"right"})}(window.burza.utils,jQuery);